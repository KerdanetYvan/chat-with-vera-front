<div class="pt-[62px] relative min-h-screen">
  @if (isDarkMode) {
    <img src="assets/bg_mobile_dark.jpg" alt="" role="background" class="fixed md:hidden lg:hidden inset-0 w-full h-full object-cover pointer-events-none select-none z-0" />
    <img src="assets/bg_desktop_dark.jpg" alt="" role="background" class="fixed hidden md:block lg:block inset-0 w-full h-full object-cover pointer-events-none select-none z-0" />
  } @else {
    <img src="assets/bg_mobile.png" alt="" role="background" class="fixed md:hidden lg:hidden inset-0 w-full h-full object-cover pointer-events-none select-none z-0" />
    <img src="assets/bg_desktop.png" alt="" role="background" class="fixed hidden md:block lg:block inset-0 w-full h-full object-cover pointer-events-none select-none z-0" />
  }

  <app-nav-bar class="fixed top-0 left-0 w-full z-50"></app-nav-bar>

  <main class="relative z-10 px-6 py-8 max-w-7xl mx-auto">
    <!-- Header avec statut de connexion -->
    <div class="mb-8">
      <div class="flex items-center justify-between mb-4">
        <h1 class="text-[38px] font-family-lastik text-[#111110] dark:text-[#DBF9BE]">Dashboard VERA</h1>
        <div class="flex items-center gap-2">
          <div class="w-3 h-3 rounded-full {{ isConnected ? 'bg-green-500' : 'bg-red-500' }} animate-pulse"></div>
          <span class="text-[14px] font-family-fustat text-[#111110] dark:text-[#FEF2E4]">
            {{ isConnected ? 'Connecté' : 'Déconnecté' }}
          </span>
        </div>
      </div>
    </div>

    <!-- Messages d'état -->
    @if(loading) {
      <div class="bg-[#FEF2E4]/95 dark:bg-[#1F1C19]/95 rounded-[20px] p-6 text-center">
        <p class="text-[18px] font-family-fustat text-[#111110] dark:text-[#FEF2E4]">Chargement...</p>
      </div>
    }

    @if(error) {
      <div class="bg-red-100 dark:bg-red-900/30 rounded-[20px] p-6 text-center mb-6">
        <p class="text-[18px] font-family-fustat text-red-800 dark:text-red-200">{{ error }}</p>
      </div>
    }

    <!-- Statistiques générales -->
    @if(overview) {
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
        <div class="bg-[#FEF2E4]/95 dark:bg-[#1F1C19]/95 rounded-[20px] p-6 shadow-lg">
          <h3 class="text-[18px] font-family-fustat text-[#111110]/60 dark:text-[#FEF2E4]/60 mb-2">Utilisateurs</h3>
          <p class="text-[42px] font-family-lastik text-[#111110] dark:text-[#DBF9BE]">{{ overview.stats?.totalUsers ?? 0 }}</p>
        </div>

        <div class="bg-[#FEF2E4]/95 dark:bg-[#1F1C19]/95 rounded-[20px] p-6 shadow-lg">
          <h3 class="text-[18px] font-family-fustat text-[#111110]/60 dark:text-[#FEF2E4]/60 mb-2">Réponses totales</h3>
          <p class="text-[42px] font-family-lastik text-[#111110] dark:text-[#DBF9BE]">{{ overview.stats?.totalResponses ?? 0 }}</p>
        </div>
      </div>
    }

    <!-- Section réponses en temps réel -->
    <div class="bg-[#FEF2E4]/95 dark:bg-[#1F1C19]/95 rounded-[20px] p-8 shadow-lg">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-[28px] font-family-lastik text-[#111110] dark:text-[#DBF9BE]">Réponses en temps réel</h2>
        <span class="text-[14px] font-family-fustat text-[#111110]/60 dark:text-[#FEF2E4]/60">
          {{ responses.length }} réponse(s)
        </span>
      </div>

      @if(responses.length === 0) {
        <div class="text-center py-12">
          <p class="text-[18px] font-family-fustat text-[#111110]/60 dark:text-[#FEF2E4]/60">
            En attente de nouvelles réponses...
          </p>
        </div>
      } @else {
        <div class="space-y-4 max-h-[600px] overflow-y-auto">
          @for(response of responses; track response.id) {
            <div class="bg-white dark:bg-[#111110] rounded-xl p-6 shadow-md border-l-4 border-[#DBF9BE] hover:shadow-lg transition-shadow">
              <!-- Header de la carte -->
              <div class="flex items-start justify-between mb-4">
                <div class="flex-1">
                  <div class="flex items-center gap-2 mb-2">
                    <span class="inline-block px-3 py-1 bg-[#DBF9BE]/30 dark:bg-[#DBF9BE]/20 text-[#111110] dark:text-[#DBF9BE] rounded-full text-[12px] font-family-fustat font-medium">
                      {{ response.whereDoYouHeard }}
                    </span>
                  </div>
                  <p class="text-[12px] font-family-fustat text-[#111110]/60 dark:text-[#FEF2E4]/60">
                    {{ formatDate(response.horodateur) }}
                  </p>
                </div>
              </div>

              <!-- Contenu de la réponse -->
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-[14px] font-family-fustat">
                <div>
                  <span class="text-[#111110]/60 dark:text-[#FEF2E4]/60">Facilité :</span>
                  <span class="ml-2 text-[#111110] dark:text-[#FEF2E4] font-medium">{{ response.veraEasy }}/5</span>
                </div>
                <div>
                  <span class="text-[#111110]/60 dark:text-[#FEF2E4]/60">Gain de temps :</span>
                  <span class="ml-2 text-[#111110] dark:text-[#FEF2E4] font-medium">{{ response.winTime }}/5</span>
                </div>
                <div>
                  <span class="text-[#111110]/60 dark:text-[#FEF2E4]/60">Fiabilité :</span>
                  <span class="ml-2 text-[#111110] dark:text-[#FEF2E4] font-medium">{{ response.fiability }}/5</span>
                </div>
                <div>
                  <span class="text-[#111110]/60 dark:text-[#FEF2E4]/60">Recommandation :</span>
                  <span class="ml-2 text-[#111110] dark:text-[#FEF2E4] font-medium">{{ response.recommandation }}/10</span>
                </div>
              </div>

              <!-- Plus apprécié -->
              @if(response.moreLiked) {
                <div class="mt-4 pt-4 border-t border-[#111110]/10 dark:border-[#FEF2E4]/10">
                  <p class="text-[12px] text-[#111110]/60 dark:text-[#FEF2E4]/60 mb-1">Ce qui a été le plus apprécié :</p>
                  <p class="text-[14px] text-[#111110] dark:text-[#FEF2E4]">{{ response.moreLiked }}</p>
                </div>
              }

              <!-- Problème rencontré -->
              @if(response.problem === 'oui' && response.ifProblem) {
                <div class="mt-4 pt-4 border-t border-[#111110]/10 dark:border-[#FEF2E4]/10">
                  <p class="text-[12px] text-[#111110]/60 dark:text-[#FEF2E4]/60 mb-1">Problème rencontré :</p>
                  <p class="text-[14px] text-[#111110] dark:text-[#FEF2E4]">{{ response.ifProblem }}</p>
                </div>
              }

              <!-- Suggestion -->
              @if(response.suggestion) {
                <div class="mt-4 pt-4 border-t border-[#111110]/10 dark:border-[#FEF2E4]/10">
                  <p class="text-[12px] text-[#111110]/60 dark:text-[#FEF2E4]/60 mb-1">Suggestion :</p>
                  <p class="text-[14px] text-[#111110] dark:text-[#FEF2E4]">{{ response.suggestion }}</p>
                </div>
              }
            </div>
          }
        </div>
      }
    </div>
  </main>
</div>
