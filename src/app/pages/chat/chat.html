<div class="chat-container">
  <app-nav-bar></app-nav-bar>

  <!-- Liste des messages -->
  <div class="messages">
    @for (msg of messages; track $index) {
      <div
        class="message"
        [class.user]="msg.role === 'user'"
        [class.vera]="msg.role === 'vera'"
      >
        <div class="meta">
          <span class="role">
            {{ msg.role === 'user' ? 'Vous' : 'VERA' }}
          </span>
          <span class="time">
            {{ msg.createdAt | date:'shortTime' }}
          </span>
        </div>
        <p class="content">
          {{ msg.content }}
        </p>
      </div>
    }

    <!-- Indicateur de chargement -->
    @if(isLoading) {
      <div class="loading-indicator">
        <div class="loading-dots">
          <span></span>
          <span></span>
          <span></span>
        </div>
        <span class="loading-text">VERA rÃ©flÃ©chit...</span>
      </div>
    }
  </div>

  @if (hasFiles) {
    <p class="files-info">
      {{ selectedFiles.length }} fichier(s) prÃªt(s) Ã  Ãªtre envoyÃ©(s)
    </p>
  }


  <!-- Formulaire d'envoi -->
  <form class="input-area" (ngSubmit)="onSubmit()">
    <textarea
      [(ngModel)]="input"
      name="question"
      rows="2"
      placeholder="Pose ta question Ã  VERA..."
    ></textarea>

    <label class="file-input">
      <input
        type="file"
        multiple
        (change)="onFilesSelected($event)"
      />
      <span>ðŸ“Ž Joindre des fichiers</span>
    </label>

    <button type="submit" [disabled]="isLoading || !input.trim()">
      Envoyer
    </button>
  </form>

</div>
<hr />
<pre>isLoading: {{ isLoading }}</pre>
<pre>messages: {{ messages | json }}</pre>
